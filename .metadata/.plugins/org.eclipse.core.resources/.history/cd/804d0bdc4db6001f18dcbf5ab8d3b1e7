/*
 * publisher.c
 *
 *  Created on: Dec 8, 2024
 *      Author: Nathaniel Correa
 */

#include <stddef.h>
#include <stdbool.h>
#include "publisher.h"
#include "main.h"

static node_t* head = NULL;

void publish(node_t* node) {
	node->_l_ival = node->ival;
	node->notify = true;
	insert(head, node);
}

void notify_all() {
	node_t* node = head;
	while (node != NULL) {
		node->notify = true;
		node = node->next;
	}
}

int notify(uint32_t param_id) {
	node_t* node = search(head, param_id);
	if (node == NULL) return -1;
	node->notify = true;
}

void notify_loop() {
	node_t* node = head;
	static CAN_TxHeaderTypeDef std_header = {
			.StdId = CAN_ID,
			.IDE = CAN_ID_STD,
			.RTR = CAN_RTR_DATA,
			.DLC = 8,
			.TransmitGlobalTime = DISABLE
	};

	while (node != NULL) {

	}
}
